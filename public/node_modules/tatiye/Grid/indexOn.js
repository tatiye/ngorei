import tatiyeNet  from "../es6.js"; 
export function setGrid(row) {
var appColom=''; 
$.each(row.grid.header,function(key1, row1){
   var headerID =row.grid.header[key1].replace(/[^A-Za-z0-9]/g, '');
      $.post(tatiyeNet.autoload,{
                 "package"      :row.package+'/'+row.grid.route[key1],
                  "key"         :'inikey',
                  "resheader"   :headerID,
                 beforeSend: function() {
                      $("#gridBody"+headerID).html(`
                        <div style="width:200px;margin: auto; margin-top: 200px;" class="col-md-12">
                               <div class="spinner-border text-primary " role="status">
                                 <span class="sr-only">Loading...</span>
                               </div>
                       </div>
                      `); 
                 },
                })
               .done(function (data) {
                  $("#gridBody"+headerID).html(data);  
              });
             const getGrid      =JSON.parse(localStorage.getItem('appGrid'));
               if (getGrid.setId[key1]) {
                   var appGridID      =getGrid.setId[key1];
                   var appGridColom   =getGrid.setClass[key1];
                   var appGridHeader  =getGrid.setHeader[key1];
               } else {
                   var appGridID      =headerID;
                   var appGridColom   =row.grid.colom[key1];
                   var appGridHeader  =row.grid.header[key1];
               }

             var desain=`<div id="${appGridID}" class="${appGridColom}" 
                   data-id="${appGridID}"
                   data-colom="${row.grid.colom[key1]}"
                   data-header="${row.grid.header[key1]}">
                       <div class="setModal">
                       <div id="modalHeader">
                       <div class="
                              setModal-header
                              d-flex
                              align-items-center
                              justify-content-between">
                              <h5 id="headerGrid"  class="mg-b-0">${appGridHeader}</h5>
                               <div class="d-flex"> 
                                  <a  class="link-03 ml-10px mr-5px"href="javascript:void(0);">
                                     <i class="fs-15px ms-Icon ms-Icon--ChromeMinimize"></i>
                                  </a>   
                                  <a  class="link-03 ml-10px mr-5px"href="javascript:void(0);">
                                      <i class="ms-Icon ms-Icon--ChromeRestore" id="welcomeMinimize"></i>
                                  </a>
                                  <a  class="myclose link-03 ml-1px mr-0px"href="javascript:void(0);">
                                       <i class="feat icon-25px feat-more-vertical "></i>
                                  </a>
                            </div>
                          </div>
                        </div>
                        <div id="gridBody${appGridID}"class="setModal-body"></div>
                      </div>
                      </div>`;
                        appColom +=desain; 
});
  var template=`
<div class="${row.grid.classRow} pd-t-10">
    <div class="row  row-xs"id="grid">
    ${appColom}
    </div>
</div>
`;
$("#"+row.autoload).html(template);
$("#grid").sortable({
        handle: "#headerGrid",
         cursor: 'move', 
         update: function() {
              var order = $("#grid").sortable("toArray"); 
              var actionFrom =JSON.stringify(order, null, 10);
              var addset = JSON.parse(actionFrom); 
                const getId     =[];
                const getClass  =[];
                const getHeader =[];
               $.each(addset,function(key, row){
                      var setId      =$('#'+row).data("id");
                      var setClass   =$('#'+row).data('colom');
                      var setHeader  =$('#'+row).data('header');
                      getId[key]     =setId;
                      getClass[key]  =setClass;
                      getHeader[key] =setHeader;                   
                 });
                    const appGrid = {
                      "setId": getId,
                      "setClass": getClass,
                      "setHeader":getHeader
                    };
                    localStorage.setItem('appGrid', JSON.stringify(appGrid));
     }                                 
   });
};
